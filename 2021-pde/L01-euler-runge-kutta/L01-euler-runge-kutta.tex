\documentclass{article}

% Используемые пакеты.
\usepackage[top=2cm,bottom=2cm,left=2.5cm,right=2.5cm]{geometry} % размеры полей
\usepackage{amsmath,amsthm,amscd,amsfonts,amssymb}               % специальные символы и т.п.
\usepackage{indentfirst}                                         % отступ для начала абзаца
\usepackage{textcomp}                                            % текст в формулах
\usepackage{graphicx}                                            % подключение графики
\usepackage[cp1251]{inputenc}                                    % чтобы документ открывался в редакторе MikTex
\usepackage[T2A]{fontenc}                                        % для поддержки русского языка
\usepackage[english,russian]{babel}                              % включение русского языка
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{mathtools}

% Нумерация по секциям.
% \numberwithin{equation}{section}

% Стили для теорем, лемм и определений.
\theoremstyle{plain}
\newtheorem{theorem}{Теорема}[section]
\newtheorem{lemma}{Лемма}[section]
\newtheorem{definition}{Определение}[section]

\begin{document}

\title{Лекция 1. Численное решение обыкновенных дифференциальных уравнений.}
\date{}

\maketitle

\section{Основные определения}

\begin{definition}
Соотношение вида
\begin{equation}
\frac{d^My}{dx^M} = f(x, y, y', y'', \ldots, y^{(M - 1)})
\end{equation}
называется обыкновенным дифференциальным уравнением (ОДУ) $M$-го порядка.
\end{definition}

Так как произвольное ОДУ $M$-го порядка можно свести к системе ОДУ первого порядка с помощью введения вспомогательных функций $y_m(x) = y^{(m)}(x), \ , m \le M - 1$, то в дальнейшем будем рассматривать только системы ОДУ первого порядка.

\begin{definition}
Соотношения вида
\begin{equation}
\frac{dy_m}{dx} = f_m(x, y_1, y_2, \ldots, y_M), \ 1 \le m \le M)
\end{equation}
называются системой ОДУ первого порядка. 
\end{definition}

Система ОДУ может быть записана в векторных обозначениях:

\begin{equation}
\frac{dy}{dx} = f(x, y), \ y = \{ y_1, y_2, \ldots, y_M \}, \ f = \{ f_1, f_2, \ldots, f_M \}
\end{equation}

\begin{definition}
Задачей Коши называется система ОДУ с дополнительными условиями, заданными в одной точке в виде $y(x_0) = y_0$.
\end{definition}

Из курса ОДУ известны следующие теоремы:

\begin{theorem}
Если в задаче Коши $\frac{dy}{dx} = f(x, y), \ y(x_0) = y_0$ функция $f$ непрерывна в некоторой окрестности начальной точки $\{x_0, y_0\}$ интегральной кривой, то задача имеет решение (возможно не единственное).
\end{theorem}

\begin{theorem}
Если в задаче Коши $\frac{dy}{dx} = f(x, y), \ y(x_0) = y_0$ функция $f$ не только непрерывна в некоторой окрестности начальной точки $\{x_0, y_0\}$ интегральной кривой, но и удовлетворяет условию Липшица по переменным $y_m$, то задача имеет решение, это решение единственно и непрерывно зависит от координат начальной точки. Это означает корректность постановки задачи Коши.
\end{theorem}

\begin{theorem}
Если в задаче Коши $\frac{dy}{dx} = f(x, y), \ y(x_0) = y_0$ функция $f$ непрерывна в некоторой окрестности начальной точки $\{x_0, y_0\}$ интегральной кривой, удовлетворяет условию Липшица по переменным $y_m$, и имеет непрерывные производные вплоть до $p$-го порядка по всем аргументам, включая $x$, то задача имеет решение, это решение единственно, непрерывно зависит от координат начальной точки и имеет $(p + 1)$-ю непрерывную производную по $t$.
\end{theorem}

\begin{definition}
Система ОДУ вида $\frac{dy}{dx} = f(y)$ ($f$ не зависит от $x$) называют автономной.
\end{definition}

Любая система ОДУ может быть приведена к виду автономной системы с помощью введения вспомогательной функции $y_{M + 1}(x) = x$. Данный процесс называется автономизацией.

\section{Метод Эйлера численного решения задачи Коши}

Пусть рассматривается ОДУ

\begin{equation}
y' = f(x, y)
\end{equation}

при начальном условии $y(x_0) = y_0$, $f(x, y)$ - функция, аналитическая в точке $(x_0, y_0)$.

С помощью правил дифференциирования сложной функции можно получить значения старших производных функции $y$:

\begin{equation}
y'' = f_x(x, y) + f_y(x, y)y'
\end{equation}

\begin{equation}
y''' = f_{xx}(x, y) + 2f_{xy}(x, y)y' + f_{yy}(x, y)y'^2 + f_y(x, y)y''
\end{equation}

Далее, применяя формулу Тейлора, получим

\begin{equation}
y(x) \approx \sum_{i = 0}^{n}{\frac{y^{(i)}(x_0)}{i!}(x - x_0)^i}
\end{equation}

Если значение $|x - x_0|$ меньше радиуса сходимости ряда 

\begin{equation}
\sum_{i}{\frac{y^{(i)}(x_0)}{i!}(x - x_0)^i}
\end{equation}

то данная формула неприменима.

В таком случае можно поступить следующим образом. Если решение задачи Коши требуется найти на некотором промежутке $[x_0, x_0 + X]$, то этот промежуток разбивается на точки $x_j$, $j = 0, \ldots, N$, $x_N = x_0 + X$ и значения функции $y_j$ вычисляются последовательно:

\begin{equation}
y_{j + 1} = \sum_{i = 0}^{n}{\frac{y_j^{(i)}}{i!}(x_{j + 1} - x_j)^i}
\end{equation}

Будем рассматривать только равномерное разбиение промежутка поиска решений $[x_0, x_0 + X]$ на отрезки длины $h$, тогда формула принимает вид

\begin{equation}
y_{j + 1} = \sum_{i = 0}^{n}{\frac{y_j^{(i)}}{i!}h^i}
\end{equation}

При $n = 1$ данная формула превращается в

\begin{equation}
y_{j + 1} = y_i + hf(x_j, y_j)
\end{equation}

Данный метод вычисления называется методом Эйлера.

\section{Метод Адамса численного решения задачи Коши}

Метод Эйлера можно получить другим способом из соотношения

\begin{equation}
y(x + h) = y(x) + \int_0^h{y'(x + t)dt}
\end{equation}

заменяя интеграл приближенной формулой прямоугольников

\begin{equation}
y(x + h) = y(x) + h f(x, y(x)) + O(h^2)
\end{equation}

Если вместо формулы прямоугольников воспользоваться квадратурной формулой трапеций, то получим соотношение

\begin{equation}
y(x + h) = y(x) + \frac{h}{2}\left(y'(x) + y'(x + h)\right) + O(h^3)
\end{equation}

то есть 

\begin{equation}
y_{j + 1} = y_j + \frac{h}{2}\left(f(x_j, y_j) + f(x_{j + 1}, y_{j + 1})\right) + O(h^3)
\end{equation}

Данная формула называется неявной формулой Адамса второго порядка точности.

Для разрешения данной схемы вычислим значение $y_{j + 1}$ в правой части с помощью формулы Эйлера:

\begin{eqnarray}
y_{j + 1}^{*} = y_j + h f(x_j, y_j) \\
y_{j + 1} = y_j + \frac{h}{2}\left(f(x_j, y_j) + f(x_{j + 1}, y_{j + 1}^{*})\right)
\end{eqnarray}

\section{Методы Рунге-Кутты численного решения задачи Коши}

В общем виде семейство методов Рунге-Кутты записывается следующим образом. Пусть в процессе вычислений фиксированы числа $\alpha_2, \alpha_2, \ldots, \alpha_q$, $p_1, p_2, \ldots, p_q$, $\beta_{ij}, \ 0 < j < i \le q$. Тогда схема Рунге-Кутты представлена следующей последовательностью вычислений:

\begin{eqnarray}
k_1(h) = h f(x, y) \\
k_2(h) = h f(x + \alpha_2 h, y + \beta_{21} k_1(h)) \\
\ldots \\
k_q(h) = h f(x + \alpha_q h, y + \beta_{q,1} k_1(h) + \ldots + \beta_{q, q - 1}k_{q - 1}(h)) \\
y(x + h) \approx z(h) = y(x) + \sum_{i = 1}^{q}{p_ik_i(h)}
\end{eqnarray}

При этом коэффициенты $\alpha_i$, $p_i$, $\beta_{ij}$ выбираются таким образом, чтобы для функции $\phi(h) = y(x + h) - z(h)$, раскладываемой в ряд Тейлора,

\begin{equation}
\phi(h) = \sum_{i = 0}^{s}{\frac{\phi^{(i)}(0)}{i!}h^i} + \frac{\phi^{(s + 1)}(\theta h)}{(s + 1)!}h^{s + 1}
\end{equation}

первые $s$ производных в точке $h = 0$ обращались в ноль: $\phi'(0) = \ldots = \phi^{(s)} = 0$. В этом случае $s$ называют порядком погрешности метода.

При $q = 1$ получим метод Эйлера с первым порядком погрешности.

При $q = s = 2$ можно получить, например следующую схему второго порядка:

\begin{eqnarray}
y_{j + \frac{1}{2}} = y_j + \frac{h}{2}f(x_j, y_j) \\
y_{j + 1} = y_j + h f\left(x_j + \frac{h}{2}, y_{j + \frac{1}{2}}\right)
\end{eqnarray}

При $q = s = 3$ наиболее часто используемой схемой является следующая:

\begin{eqnarray}
k_1 = h f(x, y) \\
k_2 = h f\left(x + \frac{h}{2}, y + \frac{k_1}{2}\right) \\
k_3 = h f(x + h, y - k_1 + 2k_2) \\
\Delta y = \frac{1}{6}(k_1 + 4k_2 + k_3)
\end{eqnarray}

При $q = s = 4$ наиболее часто используемой схемой является следующая:

\begin{eqnarray}
k_1 = h f(x, y) \\
k_2 = h f\left(x + \frac{h}{2}, y + \frac{k_1}{2}\right) \\
k_3 = h f\left(x + \frac{h}{2}, y + \frac{k_2}{2}\right) \\
k_4 = h f(x + h, y + k_3) \\
\Delta y = \frac{1}{6}(k_1 + 2k_2 + 2k_3 + k_4)
\end{eqnarray}

\end{document}
